<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Real Time Todolist</title>
</head>
<body>
    <h1>Todolist</h1>

    <form id="form" action="" method="">
        <input id="task" type="text" name="task" placeholder="Tasks">
        <input type="submit" value="Add">
    </form>

    <section>
        <ul id="todo"></ul>
    </section>
    <section>
        <ul id="done"></ul>
    </section>

    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
        const socket = io();
        
        let form = document.getElementById('form');
        let inputTask = document.getElementById('task');
        let todo = document.getElementById('todo');
        let done = document.getElementById('done');

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            let inputValue = inputTask.value;

            let data = {
                task : inputValue,
                done : false
            }
            // console.log(inputValue);
            socket.emit('new_task', data);

            if (alltasks.length == 0) {
                todo.innerHTML = '';
            }
            
            alltasks.push(tododata);
            todo.innerHTML += '<li>'+ alltasks[alltasks.length-1] +'</li>'


            inputTask.focus();
            inputTask.value = '';
        })

        socket.on('todo', (tododata) => {
            if (tododata.length > 0) {
                todolist = '';
            } else {
                todolist = 'Empty';
            }
            
            for (let i = 0; i < tododata.length; i++) {
                todolist += '<li>'+ tododata[i] +'</li>';
            }
            
            todo.innerHTML = todolist;
        })

        socket.on('add_task', (tododata) => {
            if (alltasks.length == 0) {
                todo.innerHTML = '';
            }
            
            alltasks.push(tododata);
            todo.innerHTML += '<li>'+ alltasks[alltasks.length-1] +'</li>'
        })
        
        // function insertTasks (data) {
        //     if (alltasks) {
                
        //     }
        //     let li = document.createElement('li');
        //     li.innerHTML = '<span>'+  +'</span>'
        //     todo.appendChild(li);
        // }
    </script>
</body>
</html>